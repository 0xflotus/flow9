import wigi/types;
import gui;

export {
	setWigify(fn : (WigiElement, [WigiStyles]) -> [WigifiedPage]) -> void;
	useWigify(doc : WigiElement, defaultStyles : [WigiStyles]) -> [WigifiedPage];

	// The above functions work with each page individually, if we want to join them, we use this aggregator
	joinWigiPages(pages: [() -> Form]) -> Form;
}

wigifyFn = ref \doc : WigiElement, defaultStyles : [WigiStyles] -> [WigifiedPage(\ -> Text("Call setWigify", []), [], "", "", false, false, EmptyMarginContent())];


setWigify(fn : (WigiElement, [WigiStyles]) -> [WigifiedPage]) -> void {
	wigifyFn := fn;
}

useWigify(doc : WigiElement, defaultStyles : [WigiStyles]) -> [WigifiedPage] {
	(^wigifyFn)(doc, defaultStyles);
}

joinWigiPages(pages: [() -> Form]) -> Form {
	if (length(pages) == 1) {
		pages[0]()
	} else {
		WideLines(map(pages, apply0))
	}
}
