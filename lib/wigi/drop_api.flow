import wigi/editor_types;

import binarytree;

export {
	// register function for dropping files to general editing area of Wigi
	registerWigiDropFn(ext : string, onOK : (WigiDropParameters) -> void) -> void;
	getWigiDropFn(ext : string) -> (WigiDropParameters) -> void;

	WigiDropParameters(state : WigiEditorState, name : string, content : string);
}

dropFns : ref Tree<string, (WigiDropParameters) -> void> = ref makeTree();

registerWigiDropFn(ext : string, onOK : (WigiDropParameters) -> void) -> void {
	dropFns := setTree(^dropFns, ext, onOK)
}

getWigiDropFn(ext : string) -> (WigiDropParameters) -> void {
	dropFn = lookupTree(^dropFns, ext);
	switch(dropFn) {
		Some(fn) : fn;
		None() : {
			println("Getting Wigi DropFn Error: No block for files " + ext); 
			nop1
		}
	}

}
