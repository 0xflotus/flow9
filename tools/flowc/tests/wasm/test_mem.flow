import string;
import expect;

native wasm_dump_free_blocks : (label : int) -> void = host_w.wasm_dump_free_blocks;
native wasm_available_memory : () -> int = host_w.wasm_available_memory;
native wasm_free_memory : () -> int = host_w.wasm_free_memory;

Aaa(
	name : string,
	data : int
);

test_print(a : Aaa) {
	prints(a.name + ": " + i2s(a.data));
}

test00(a : Aaa) {
}

test0() {
	aaa = Aaa("test", 0);
}

test1() {
	aaa = Aaa("test", 0);
	test_print(aaa);
}

test() {
	for(0, \i -> i < 10, \i -> {
		aaa = Aaa("st_" + i2s(i), i);
		test_print(aaa);
		i + 1;
	});
}

main() {
	printi(0);
	printi(wasm_available_memory());
	printi(1);
	printi(wasm_free_memory());
	test00(Aaa("test", 0));
	// printi(2);
	// printi(wasm_free_memory());
	test00(Aaa("test", 0));
	printi(3);
	printi(wasm_free_memory());
}

