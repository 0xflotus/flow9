native getUrlN : io (url : string, target : string) -> void = Native.getUrl;

// foo = debugtyping;

redirectAdditionalFn = ref \fn -> {	fn() };

setRedirectAdditionalFn(fn : (() -> void) -> void) -> void {redirectAdditionalFn := fn;}

getUrl(url : string, target : string) {
	^redirectAdditionalFn(\ -> {getUrlN(url, target)});
}



----------

redirectAdditionalFn = (ref (\fn:() -> ? ->
	((fn : () -> ?)() : ?)
 : (fn : () -> ?) -> ?) : ref (fn : () -> ?) -> ?);

getUrl = (\url:string, target:string ->
	((^(redirectAdditionalFn : ref (fn : () -> void) -> void) : (() -> void) -> void)((\ ->
		((getUrlN : (url : string, target : string) -> void)((url : string), (target : string)) : void)
	 : () -> void)) : void)
 : (url : string, target : string) -> void);

setRedirectAdditionalFn = (\fn:(() -> void) -> void ->
	(((redirectAdditionalFn : ref (fn : () -> void) -> void)  :=  (fn : (() -> void) -> void)) : void)
 : (fn : (() -> void) -> void) -> void);
