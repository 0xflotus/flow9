import tools/flowc/fcmodule;
import tools/flowc/backends/javascript/fi2javascript_defines;

fcGetStructId(ctx, item : FcCase) {
	switch (lookupTree(ctx.ovl.structs, item.struct)) {
		Some(info): info.id;
		None(): fail0("invalid struct " + item.struct);
	}
}

----------

fcGetStructId = (\ctx:FiJsToplevelContext, item:FcCase ->
	(gsymswitch0 : Maybe<FiJsStruct> = ((lookupTree : (tree : Tree<string, FiJsStruct>, key : string) -> Maybe<FiJsStruct>)((((ctx : FiJsToplevelContext).ovl : FiJsOverlayGroup).structs : Tree<string, FiJsStruct>), ((item : FcCase).struct : string)) : Maybe<FiJsStruct>);
	({
		(switch (gsymswitch0 : Maybe<FiJsStruct>) {
			Some(info): {
				(info : FiJsStruct = ((gsymswitch0 : Some<FiJsStruct>).value : FiJsStruct);
				((info : FiJsStruct).id : int) : int)
			}
			None(): {
				((fail0 : (msg : string) -> int)(((("invalid struct " : string) + ((item : FcCase).struct : string)) : string)) : int)
			}
		} : int)
	}
	 : int) : int)
 : (ctx : FiJsToplevelContext, item : FcCase) -> int);
