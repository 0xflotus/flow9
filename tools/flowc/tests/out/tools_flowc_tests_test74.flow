import form/gui;
/*
WidthHeight(width : double, height : double);

	zeroWH = WidthHeight(0.0, 0.0);

makeWH() -> DynamicBehaviour<WidthHeight> {
	make(zeroWH)
}
*/
foo() {
	wh = makeWH();
	complete = ref false;
	uns = ref nop;
	uns := subscribe(select(wh, \wwhh -> wwhh.width * wwhh.height > 0.0),
		\loaded -> if (loaded && !^complete) {
			complete := true;
			^uns();
		});
}

----------

foo = (\ ->
	(wh : DynamicBehaviour<WidthHeight> = ((makeWH : () -> DynamicBehaviour<WidthHeight>)() : DynamicBehaviour<WidthHeight>);
	({
		(complete : ref bool = (ref (false : bool) : ref bool);
		({
			(uns : ref () -> void = (ref (nop : () -> void) : ref () -> void);
			({
				(((uns : ref () -> void)  :=  ((subscribe : (b : Behaviour<bool>, f : (bool) -> void) -> () -> void)(((select : (behaviour : Behaviour<WidthHeight>, fn : (WidthHeight) -> bool) -> Behaviour<bool>)((wh : DynamicBehaviour<WidthHeight>), (\wwhh:WidthHeight ->
					((((((wwhh : WidthHeight).width : double) * ((wwhh : WidthHeight).height : double)) : double) > (0.0 : double)) : bool)
				 : (wwhh : WidthHeight) -> bool)) : Behaviour<bool>), (\loaded:bool ->
					(if ((((loaded : bool) && (!(^(complete : ref bool) : bool) : bool)) : bool)) {
						({
							(((complete : ref bool)  :=  (true : bool)) : void);
							((^(uns : ref () -> void) : () -> void)() : void)
						}
						 : void)
					} else {
						({} : void)
					}
					 : void)
				 : (loaded : bool) -> void)) : () -> void)) : void)
			}
			 : void) : void)
		}
		 : void) : void)
	}
	 : void) : void)
 : () -> void);
