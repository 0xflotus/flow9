export {
	WigiElement ::= WigiDocument, WigiStory, WigiParagraph;
		WigiDocument(root : WigiElement, style : [WigiDocumentStyle]);
			WigiDocumentStyle ::= WigiName;

		WigiStory(paragraphs : ref [WigiElement], views : ref [int], style : [WigiStoryStyle]);
			WigiStoryStyle ::= WigiName, ParagraphSpacing, WigiReference;
				ParagraphSpacing(d : double);
				WigiReference(tree : [string]);

		WigiParagraph(elements : [WigiElement], style : [WigiParagraphStyle]);
			WigiParagraphStyle ::= FixedWidth, ReplaceTightWidthWithAlign, GeneralIndent;
				FixedWidth();
				ReplaceTightWidthWithAlign();
				GeneralIndent(indent : double);

	WigiStyle ::= WigiDocumentStyle, WigiStoryStyle, WigiParagraphStyle;
		WigiName(name : string);
}

doCompareWigi(wigi1 : WigiElement, wigi2 : WigiElement) -> bool {
	checkStylesEqual = \st1 : [WigiStyle], st2 : [WigiStyle] ->{
		false;
	}

	switch (wigi1 : WigiElement) {
		WigiDocument(r, style): {
			e2 = cast(wigi2 : WigiElement -> WigiDocument);
			checkStylesEqual(style, e2.style);
		}
		WigiStory(par, views, style): {
			e2 = cast(wigi2 : WigiElement -> WigiStory);
			checkStylesEqual(style, e2.style);
		}
		WigiParagraph(elements, style): {
			e2 = cast(wigi2 : WigiElement -> WigiParagraph);
			s1 = subtractA(normalizeWigiParagraphStyle(style), []);
			s2 = subtractA(normalizeWigiParagraphStyle(e2.style), []);
			checkStylesEqual(s1, s2);
		}
	}
}

normalizeWigiParagraphStyle(paraStyle : [WigiParagraphStyle]) -> [WigiParagraphStyle] {
	[];
}


subtractA(a : [?], b : [?]) -> [?] {
	a
}

----------

normalizeWigiParagraphStyle = (\paraStyle:[WigiParagraphStyle] ->
	([] : [WigiParagraphStyle])
 : (paraStyle : [WigiParagraphStyle]) -> [WigiParagraphStyle]);

subtractA = (\a:[?], b:[?] ->
	(a : [?])
 : (a : [?], b : [?]) -> [?]);

doCompareWigi = (\wigi1:WigiElement, wigi2:WigiElement ->
	(checkStylesEqual : ([WigiStyle], [WigiStyle]) -> bool = (\st1:[WigiStyle], st2:[WigiStyle] ->
		(false : bool)
	 : (st1 : [WigiStyle], st2 : [WigiStyle]) -> bool);
	({
		(switch (wigi1 : WigiElement) {
			WigiDocument(r,style): {
				(r : WigiElement = ((wigi1 : WigiDocument).root : WigiElement);
				(style : [WigiDocumentStyle] = ((wigi1 : WigiDocument).style : [WigiDocumentStyle]);
				(e2 : WigiDocument = (cast((wigi2 : WigiElement) : WigiElement -> WigiDocument) : WigiDocument);
				({
					((checkStylesEqual : ([WigiStyle], [WigiStyle]) -> bool)((style : [WigiDocumentStyle]), ((e2 : WigiDocument).style : [WigiDocumentStyle])) : bool)
				}
				 : bool) : bool) : bool) : bool)
			}
			WigiStory(par,views,style): {
				(par : ref [WigiElement] = ((wigi1 : WigiStory).paragraphs : ref [WigiElement]);
				(views : ref [int] = ((wigi1 : WigiStory).views : ref [int]);
				(style : [WigiStoryStyle] = ((wigi1 : WigiStory).style : [WigiStoryStyle]);
				(e2 : WigiStory = (cast((wigi2 : WigiElement) : WigiElement -> WigiStory) : WigiStory);
				({
					((checkStylesEqual : ([WigiStyle], [WigiStyle]) -> bool)((style : [WigiStoryStyle]), ((e2 : WigiStory).style : [WigiStoryStyle])) : bool)
				}
				 : bool) : bool) : bool) : bool) : bool)
			}
			WigiParagraph(elements,style): {
				(elements : [WigiElement] = ((wigi1 : WigiParagraph).elements : [WigiElement]);
				(style : [WigiParagraphStyle] = ((wigi1 : WigiParagraph).style : [WigiParagraphStyle]);
				(e2 : WigiParagraph = (cast((wigi2 : WigiElement) : WigiElement -> WigiParagraph) : WigiParagraph);
				({
					(s1 : [WigiStyle] = ((subtractA : (a : [WigiStyle], b : [WigiStyle]) -> [WigiStyle])(((normalizeWigiParagraphStyle : (paraStyle : [WigiParagraphStyle]) -> [WigiParagraphStyle])((style : [WigiParagraphStyle])) : [WigiParagraphStyle]), ([] : [WigiStyle])) : [WigiStyle]);
					({
						(s2 : [WigiStyle] = ((subtractA : (a : [WigiStyle], b : [WigiStyle]) -> [WigiStyle])(((normalizeWigiParagraphStyle : (paraStyle : [WigiParagraphStyle]) -> [WigiParagraphStyle])(((e2 : WigiParagraph).style : [WigiParagraphStyle])) : [WigiParagraphStyle]), ([] : [WigiStyle])) : [WigiStyle]);
						({
							((checkStylesEqual : ([WigiStyle], [WigiStyle]) -> bool)((s1 : [WigiStyle]), (s2 : [WigiStyle])) : bool)
						}
						 : bool) : bool)
					}
					 : bool) : bool)
				}
				 : bool) : bool) : bool) : bool)
			}
		} : bool)
	}
	 : bool) : bool)
 : (wigi1 : WigiElement, wigi2 : WigiElement) -> bool);
