import stylestructs;

Tropic ::= TEmpty, TBorder; 
	TEmpty();
	TBorder(i : int, child : Tropic);


TRectangle(style : [GraphicsStyle], size : Tropic) -> Tropic {
	TEmpty()
}

// a = debugtyping;

foo(color) {
	fn = \s -> {
		TRectangle([s], 
			TEmpty()
		)
	};
	[
		fn(Fill((color))),
		fn(FillOpacity(0.0)),
	]
}

----------

TRectangle = (\style:[GraphicsStyle], size:Tropic ->
	(TEmpty() : TEmpty)
 : (style : [GraphicsStyle], size : Tropic) -> TEmpty);

foo = (\color:int ->
	(fn : (GraphicsStyle) -> Tropic = (\s:GraphicsStyle ->
		((TRectangle : (style : [GraphicsStyle], size : Tropic) -> Tropic)(([(s : GraphicsStyle)] : [GraphicsStyle]), (TEmpty() : TEmpty)) : Tropic)
	 : (s : GraphicsStyle) -> Tropic);
	({
		([((fn : (GraphicsStyle) -> Tropic)((Fill((color : int)) : Fill)) : Tropic), ((fn : (GraphicsStyle) -> Tropic)((FillOpacity((0.0 : double)) : FillOpacity)) : Tropic)] : [Tropic])
	}
	 : [Tropic]) : [Tropic])
 : (color : int) -> [Tropic]);
